# é¢˜ç›®ç®¡ç†ç³»ç»Ÿåç«¯

åŸºäº Express.js + TypeScript + MySQL çš„é¢˜ç›®ç®¡ç†ç³»ç»Ÿåç«¯APIã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ” JWTè®¤è¯å’Œæˆæƒ
- ğŸ‘¥ ç”¨æˆ·è§’è‰²ç®¡ç† (æ•™å¸ˆ/å­¦ç”Ÿ)
- ğŸ“ é¢˜ç›®CRUDæ“ä½œ
- âœ… ç­”é¢˜å’Œè¯„åˆ†ç³»ç»Ÿ
- ğŸ“Š å­¦ä¹ ç»Ÿè®¡å’Œåˆ†æ
- ğŸ›¡ï¸ è¾“å…¥éªŒè¯å’Œé”™è¯¯å¤„ç†
- ğŸ“ å®Œæ•´çš„æ—¥å¿—è®°å½•
- ğŸ—„ï¸ è‡ªåŠ¨æ•°æ®åº“åˆå§‹åŒ–

## æŠ€æœ¯æ ˆ

- **è¿è¡Œæ—¶**: Node.js
- **æ¡†æ¶**: Express.js
- **è¯­è¨€**: TypeScript
- **æ•°æ®åº“**: MySQL
- **è®¤è¯**: JWT (jsonwebtoken)
- **å¯†ç åŠ å¯†**: bcryptjs
- **éªŒè¯**: express-validator
- **æ—¥å¿—**: è‡ªå®šä¹‰æ—¥å¿—ç³»ç»Ÿ

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Node.js 16+
- MySQL 8.0+
- npm æˆ– yarn

### 2. å®‰è£…ä¾èµ–

```bash
cd backend
npm install
```

### 3. ç¯å¢ƒé…ç½®

å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿æ–‡ä»¶ï¼š

```bash
cp env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼š

```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=question_management

# æœåŠ¡å™¨é…ç½®
PORT=3001
NODE_ENV=development

# JWTé…ç½®
JWT_SECRET=your_jwt_secret_key_here
JWT_EXPIRES_IN=24h
```

### 4. æ•°æ®åº“è®¾ç½®

ç¡®ä¿MySQLæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œç„¶ååˆ›å»ºæ•°æ®åº“ï¼š

```sql
CREATE DATABASE question_management;
```

### 5. å¯åŠ¨æœåŠ¡

#### å¼€å‘æ¨¡å¼
```bash
npm run dev
```

#### ç”Ÿäº§æ¨¡å¼
```bash
npm run build
npm start
```

æœåŠ¡å°†åœ¨ `http://localhost:3001` å¯åŠ¨ã€‚

## é¡¹ç›®ç»“æ„

```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/          # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ database.ts  # æ•°æ®åº“è¿æ¥é…ç½®
â”‚   â”‚   â””â”€â”€ env.ts       # ç¯å¢ƒé…ç½®
â”‚   â”‚   â””â”€â”€ logger.ts    # æ—¥å¿—è®°å½•
â”‚   â”œâ”€â”€ controllers/     # æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ authController.ts    # è®¤è¯æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ questionController.ts # é¢˜ç›®æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ answerController.ts  # ç­”æ¡ˆæ§åˆ¶å™¨
â”‚   â”œâ”€â”€ database/        # æ•°æ®åº“ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ schema.sql   # æ•°æ®åº“ç»“æ„
â”‚   â”‚   â””â”€â”€ init.ts      # æ•°æ®åº“åˆå§‹åŒ–
â”‚   â”œâ”€â”€ middleware/      # ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ auth.ts      # è®¤è¯ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ routes/          # è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ authRoutes.ts
â”‚   â”‚   â”œâ”€â”€ questionRoutes.ts
â”‚   â”‚   â”œâ”€â”€ answerRoutes.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ types/           # TypeScriptç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ validation.ts # è¾“å…¥éªŒè¯
â”‚   â”‚   â”œâ”€â”€ errorHandler.ts # é”™è¯¯å¤„ç†
â”‚   â”‚   â””â”€â”€ logger.ts    # æ—¥å¿—è®°å½•
â”‚   â””â”€â”€ index.ts         # åº”ç”¨å…¥å£
â”œâ”€â”€ logs/                # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”œâ”€â”€ dist/                # ç¼–è¯‘è¾“å‡ºç›®å½•
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ env.example
â””â”€â”€ README.md
```

## APIæ¥å£

### è®¤è¯æ¥å£
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `GET /api/auth/profile` - è·å–ç”¨æˆ·ä¿¡æ¯

### é¢˜ç›®ç®¡ç†æ¥å£
- `GET /api/questions` - è·å–é¢˜ç›®åˆ—è¡¨
- `GET /api/questions/:id` - è·å–é¢˜ç›®è¯¦æƒ…
- `POST /api/questions` - åˆ›å»ºé¢˜ç›® (ä»…æ•™å¸ˆ)
- `PUT /api/questions/:id` - æ›´æ–°é¢˜ç›® (ä»…æ•™å¸ˆ)
- `DELETE /api/questions/:id` - åˆ é™¤é¢˜ç›® (ä»…æ•™å¸ˆ)

### ç­”é¢˜æ¥å£
- `POST /api/answers/submit` - æäº¤ç­”æ¡ˆ (ä»…å­¦ç”Ÿ)
- `GET /api/answers/my-answers` - è·å–æˆ‘çš„ç­”æ¡ˆ
- `GET /api/answers/my-stats` - è·å–å­¦ä¹ ç»Ÿè®¡
- `GET /api/answers/question-stats/:questionId` - è·å–é¢˜ç›®ç»Ÿè®¡ (ä»…æ•™å¸ˆ)

### ç³»ç»Ÿæ¥å£
- `GET /api/health` - å¥åº·æ£€æŸ¥

è¯¦ç»†APIæ–‡æ¡£è¯·å‚è€ƒ [API_DOCUMENTATION.md](./API_DOCUMENTATION.md)

## ç¤ºä¾‹ç”¨æˆ·

ç³»ç»Ÿå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºä»¥ä¸‹ç¤ºä¾‹ç”¨æˆ·ï¼š

### æ•™å¸ˆè´¦æˆ·
- ç”¨æˆ·å: `teacher1`
- å¯†ç : `password123`
- è§’è‰²: `teacher`

### å­¦ç”Ÿè´¦æˆ·
- ç”¨æˆ·å: `student1`
- å¯†ç : `password123`
- è§’è‰²: `student`

- ç”¨æˆ·å: `student2`
- å¯†ç : `password123`
- è§’è‰²: `student`

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„è·¯ç”±

1. åœ¨ `src/controllers/` ä¸­åˆ›å»ºæ§åˆ¶å™¨
2. åœ¨ `src/routes/` ä¸­åˆ›å»ºè·¯ç”±æ–‡ä»¶
3. åœ¨ `src/routes/index.ts` ä¸­æ³¨å†Œè·¯ç”±
4. æ·»åŠ ç›¸åº”çš„ç±»å‹å®šä¹‰åˆ° `src/types/index.ts`

### æ·»åŠ æ–°çš„ä¸­é—´ä»¶

1. åœ¨ `src/middleware/` ä¸­åˆ›å»ºä¸­é—´ä»¶æ–‡ä»¶
2. åœ¨è·¯ç”±ä¸­åº”ç”¨ä¸­é—´ä»¶

### æ•°æ®åº“è¿ç§»

1. ä¿®æ”¹ `src/database/schema.sql`
2. æ›´æ–° `src/database/init.ts` ä¸­çš„åˆå§‹åŒ–é€»è¾‘

## æ—¥å¿—ç³»ç»Ÿ

ç³»ç»Ÿä¼šè‡ªåŠ¨è®°å½•ä»¥ä¸‹æ—¥å¿—ï¼š

- è¯·æ±‚æ—¥å¿— (HTTPè¯·æ±‚/å“åº”)
- é”™è¯¯æ—¥å¿— (å¼‚å¸¸å’Œé”™è¯¯)
- è°ƒè¯•æ—¥å¿— (å¼€å‘ç¯å¢ƒ)
- ä¿¡æ¯æ—¥å¿— (é‡è¦æ“ä½œ)

æ—¥å¿—æ–‡ä»¶ä¿å­˜åœ¨ `logs/` ç›®å½•ä¸‹ï¼ŒæŒ‰æ—¥æœŸåˆ†æ–‡ä»¶ã€‚

## é”™è¯¯å¤„ç†

ç³»ç»Ÿä½¿ç”¨ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼š

- è‡ªåŠ¨æ•è·å’Œè®°å½•é”™è¯¯
- è¿”å›æ ‡å‡†åŒ–çš„é”™è¯¯å“åº”
- å¼€å‘ç¯å¢ƒæ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯
- ç”Ÿäº§ç¯å¢ƒéšè—æ•æ„Ÿä¿¡æ¯

## å®‰å…¨ç‰¹æ€§

- JWTä»¤ç‰Œè®¤è¯
- å¯†ç bcryptåŠ å¯†
- è¾“å…¥éªŒè¯å’Œæ¸…ç†
- SQLæ³¨å…¥é˜²æŠ¤
- CORSé…ç½®
- è§’è‰²æƒé™æ§åˆ¶

## æ€§èƒ½ä¼˜åŒ–

- æ•°æ®åº“è¿æ¥æ± 
- è¯·æ±‚æ—¥å¿—è®°å½•
- é”™è¯¯å¤„ç†ä¼˜åŒ–
- é™æ€æ–‡ä»¶ç¼“å­˜

## éƒ¨ç½²

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. è®¾ç½®ç¯å¢ƒå˜é‡ `NODE_ENV=production`
2. é…ç½®ç”Ÿäº§æ•°æ®åº“
3. è®¾ç½®å¼ºå¯†ç çš„JWTå¯†é’¥
4. ä½¿ç”¨PM2æˆ–ç±»ä¼¼å·¥å…·ç®¡ç†è¿›ç¨‹

```bash
npm run build
NODE_ENV=production npm start
```

### Dockeréƒ¨ç½²

```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY dist ./dist
EXPOSE 3001
CMD ["node", "dist/index.js"]
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥MySQLæœåŠ¡æ˜¯å¦è¿è¡Œ
   - éªŒè¯æ•°æ®åº“è¿æ¥é…ç½®
   - ç¡®è®¤æ•°æ®åº“ç”¨æˆ·æƒé™

2. **JWTè®¤è¯å¤±è´¥**
   - æ£€æŸ¥JWT_SECRETé…ç½®
   - ç¡®è®¤ä»¤ç‰Œæ ¼å¼æ­£ç¡®
   - éªŒè¯ä»¤ç‰Œæ˜¯å¦è¿‡æœŸ

3. **ç«¯å£è¢«å ç”¨**
   - ä¿®æ”¹PORTç¯å¢ƒå˜é‡
   - æ£€æŸ¥å…¶ä»–æœåŠ¡æ˜¯å¦å ç”¨ç«¯å£

4. **ç¼–è¯‘é”™è¯¯**
   - æ£€æŸ¥TypeScriptè¯­æ³•
   - ç¡®è®¤æ‰€æœ‰ä¾èµ–å·²å®‰è£…
   - éªŒè¯tsconfig.jsoné…ç½®

### è°ƒè¯•æ¨¡å¼

è®¾ç½®ç¯å¢ƒå˜é‡å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼š

```bash
NODE_ENV=development DEBUG=* npm run dev
```

## è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»ºPull Request

## è®¸å¯è¯

MIT License 